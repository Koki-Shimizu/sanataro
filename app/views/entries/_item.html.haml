// the following statement should be removed and event_item variable should be replaced with item
- event_item ||= item
// default values
- row_class = ""
- twitter_enabled = true
- edit_enabled = true
- destroy_enabled = true
- confirmation_required = link_to_confirmation_required(event_item.id, event_item.confirmation_required?, tag: @tag, mark: @mark, keyword: @keyword)
- item_name = emolettise(h event_item.name)
- from_account = colored_account_name(event_item.from_account_id)
- to_account = colored_account_name(event_item.to_account_id)

// special values
- if event_item.adjustment?
  - row_class = "item_adjustment"
  - twitter_enabled = false
  - confirmation_required = ""
  - item_name = t("label.adjustment") + " " + number_to_currency(event_item.adjustment_amount)
  - from_account = (event_item.amount < 0) ? colored_account_name(event_item.to_account_id) : '(' + t("label.adjustment") + ')'
  - to_account = (event_item.amount >= 0) ? colored_account_name(event_item.to_account_id) : '(' + t("label.adjustment") + ')'
- elsif event_item.parent_id
  - row_class = "item_move"
  - twitter_enabled = false
  - destroy_enabled = false
  - confirmation_required = link_to_confirmation_required(event_item.id, event_item.parent_item.confirmation_required?, tag: @tag, mark: @mark, keyword: @keyword)
  - item_name = "#{t(".deposit")} (#{link_to l(event_item.parent_item.action_date, format: :short) + ' ' + emolettise(h event_item.parent_item.name), relative_path(event_item.id)})".html_safe
- elsif event_item.child_item
  - item_name += " (#{link_to l(event_item.child_item.action_date, format: :short) + ' ' + t(".deposit"), relative_path(event_item.id)})".html_safe
- else
  - if @user.income_ids.include?(event_item.from_account_id)
    - row_class = "item_income"
  - elsif @user.account_ids.include?(event_item.from_account_id) && @user.account_ids.include?(event_item.to_account_id)
    - row_class = "item_move"

.item{:id => "item_#{event_item.id}", :class => "row-fluid #{row_class}"}
  .span2.item_date= l(event_item.action_date)
  .span3.item_name
    = confirmation_required
    %span.item_name_text= item_name
    = link_to_tags(event_item)
  .span2.item_from= from_account
  .span2.item_to= to_account
  .span2.item_amount=number_to_currency(event_item.amount.abs)
  .span1.item_operation
    %span{:id => "navi_#{h event_item.id}"}
      - if @tag || @mark || @keyword
        = link_to_show(event_item)
      - else
        = tweet_button(event_item) if twitter_enabled
        = link_to_edit(event_item, edit_enabled)
        = link_to_destroy(event_item, destroy_enabled)
    %span{:id => "loading_#{h event_item.id}", :style => "display: none;"}= image_tag "loading.gif", :alt => "loading..."
